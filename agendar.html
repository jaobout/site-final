<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Agendar Servi√ßo</title>

<style>
body{
    background:#0b0b0b;
    color:#fff;
    font-family:Arial, sans-serif;
    padding:20px;
}
.box{
    padding:20px;
    background:#111;
    border-radius:14px;
    max-width:480px;
    margin:auto;
}
.label{
    margin-top:12px;
    font-size:0.9rem;
    color:#ccc;
}
input[type="date"], input[type="text"]{
    width:100%;
    padding:10px;
    border-radius:8px;
    border:1px solid #333;
    margin-top:6px;
    background:#000;
    color:#fff;
}

#horarios{
    margin-top:14px;
    display:grid;
    grid-template-columns:repeat(3, 1fr);
    gap:10px;
}

.hora{
    background:#1a1a1a;
    border:1px solid #333;
    padding:10px 0;
    border-radius:10px;
    text-align:center;
    cursor:pointer;
    transition:.2s;
}
.hora:hover{
    background:#222;
    transform:scale(1.03);
}
.hora.selecionado{
    background:#25D366;
    color:#000;
    font-weight:bold;
    border-color:#25D366;
}

button{
    width:100%;
    margin-top:16px;
    padding:14px;
    font-size:1rem;
    background:#25D366;
    border:0;
    border-radius:12px;
    color:#fff;
    font-weight:bold;
    cursor:pointer;
}

.msg{
    margin-top:12px;
    font-size:0.85rem;
    color:#aaa;
}

</style>
</head>

<body>

<div class="box">

<h2 id="titulo"></h2>

<label class="label">Seu nome:</label>
<input type="text" id="nomeCliente" placeholder="Digite seu nome">

<label class="label">Escolha a data:</label>
<input type="date" id="data">

<div id="horarios"></div>

<button id="btnEnviar" style="display:none;">Enviar agendamento no WhatsApp</button>

<p class="msg">
Ap√≥s escolher o hor√°rio, voc√™ enviar√° no WhatsApp:<br>
‚Ä¢ Seu nome<br>
‚Ä¢ O hor√°rio escolhido<br>
‚Ä¢ Os servi√ßos desejados<br>
‚Ä¢ A forma de pagamento
</p>

</div>

<script>
// Servi√ßo vindo da URL
const url = new URL(window.location);
const servico = url.searchParams.get("servico") || "Servi√ßo";

document.getElementById("titulo").innerText = "Agendar: " + servico;

// N√∫mero do WhatsApp
const WHATSAPP = "5521968859279";

// Grade de hor√°rios por dia da semana
function horariosDoDia(dataSel){
    let d = new Date(dataSel);
    let dia = d.getDay();
    let horarios = [];

    function gerar(inicio, fim){
        let h = [];
        let [ih, im] = inicio.split(":").map(Number);
        let [fh, fm] = fim.split(":").map(Number);

        let atual = new Date(d);
        atual.setHours(ih, im, 0, 0);

        let limite = new Date(d);
        limite.setHours(fh, fm, 0, 0);

        while(atual <= limite){
            h.push(atual.toTimeString().slice(0,5));
            atual = new Date(atual.getTime() + 60*60*1000);
        }
        return h;
    }

    // Segunda = fechado
    if(dia === 1) return [];

    // Ter√ßa
    if(dia === 2) return gerar("09:30","19:00");

    // Quarta
    if(dia === 3) return gerar("09:30","20:00");

    // Quinta
    if(dia === 4) return gerar("09:30","20:00");

    // Sexta
    if(dia === 5) return gerar("09:30","22:00");

    // S√°bado
    if(dia === 6) return gerar("09:30","19:00");

    // Domingo
    if(dia === 0) return gerar("10:00","12:00");

    return [];
}

// Renderizar hor√°rios
let horarioSelecionado = null;

document.getElementById("data").addEventListener("change", e=>{
    const dataSel = e.target.value;
    const horarios = horariosDoDia(dataSel);
    const box = document.getElementById("horarios");
    box.innerHTML = "";

    if(horarios.length === 0){
        box.innerHTML = "<p style='grid-column:1/-1;text-align:center;color:#bbb'>Nenhum hor√°rio dispon√≠vel neste dia.</p>";
        return;
    }

    horarios.forEach(h=>{
        const div = document.createElement("div");
        div.className = "hora";
        div.innerText = h;

        div.onclick = ()=>{
            document.querySelectorAll(".hora").forEach(x=>x.classList.remove("selecionado"));
            div.classList.add("selecionado");
            horarioSelecionado = h;
            document.getElementById("btnEnviar").style.display = "block";
        };

        box.appendChild(div);
    });
});

// Bot√£o WhatsApp
document.getElementById("btnEnviar").onclick = ()=>{
    const nome = document.getElementById("nomeCliente").value.trim();
    const dataSel = document.getElementById("data").value;

    if(!nome){
        alert("Digite seu nome antes de enviar.");
        return;
    }
    if(!dataSel || !horarioSelecionado){
        alert("Escolha a data e o hor√°rio.");
        return;
    }

    const msg = encodeURIComponent(
`Ol√°, meu nome √© *${nome}*.
Gostaria de agendar *${servico}*.

üìÖ Data: ${dataSel}
‚è∞ Hor√°rio: ${horarioSelecionado}

Por favor, informe:
- Os servi√ßos desejados
- A forma de pagamento

Obrigado!`
    );

    window.open(`https://wa.me/${WHATSAPP}?text=${msg}`);
};
</script>

</body>
</html>
